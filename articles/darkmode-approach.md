---
title: ãƒ€ãƒ¼ã‚¯ãƒ¢ãƒ¼ãƒ‰å¯¾å¿œã¸ã®ã„ãã¤ã‹ã®ã‚¢ãƒ—ãƒ­ãƒ¼ãƒ
emoji: "ğŸ•¶"
type: "tech" # tech: æŠ€è¡“è¨˜äº‹ / idea: ã‚¢ã‚¤ãƒ‡ã‚¢
topics: ["javascript", "css"]
published: false
---

# ãƒ€ãƒ¼ã‚¯ãƒ¢ãƒ¼ãƒ‰å¯¾å¿œã«ã¤ã„ã¦

ç§ã¯ãƒ€ãƒ¼ã‚¯ãƒ¢ãƒ¼ãƒ‰å¤§å¥½ããªã‚“ã§ã™ãŒä¸–ã®ä¸­ã®ãƒ€ãƒ¼ã‚¯ãƒ¢ãƒ¼ãƒ‰å¯¾å¿œã®éœ€è¦ã£ã¦å®Ÿéš›ã©ã®ç¨‹åº¦ã‚ã‚‹ã®ã‹ã‚ˆãåˆ†ã‹ã£ã¦ã„ã¾ã›ã‚“ã€‚  
ãŸã ã€éœ€è¦ã«ã¯é–¢ä¿‚ãªãã‚„ã‚Šæ–¹ã¯çŸ¥ã£ã¦ãŠããŸã„ã®ã§å‚™å¿˜éŒ²ã‚‚å…¼ã­ã¦èª¿ã¹ãŸå†…å®¹ã‚’ã¾ã¨ã‚ã¦ãŠã“ã†ã¨æ€ã„ã¾ã™ã€‚

## å‰æçŸ¥è­˜

ã“ã®è¨˜äº‹ã¯ä¸‹è¨˜ã®çŸ¥è­˜ãŒã‚ã‚‹å‰æã§é€²ã‚ã¾ã™ã€‚

- ãƒ€ãƒ¼ã‚¯ãƒ¢ãƒ¼ãƒ‰ãŒãã‚‚ãã‚‚ä½•ãªã®ã‹ç†è§£ã—ã¦ã„ã‚‹
- åŸºç¤çš„ãªHTML/CSS/Javascriptã«é–¢ã™ã‚‹çŸ¥è­˜

## ãƒ€ãƒ¼ã‚¯ãƒ¢ãƒ¼ãƒ‰å¯¾å¿œã®æ‰‹æ³•

ãƒ€ãƒ¼ã‚¯ãƒ¢ãƒ¼ãƒ‰ã®å¯¾å¿œã¨è¨€ã£ã¦ã‚‚æ­£å¼åŒ–ã•ã‚ŒãŸä»•çµ„ã¿ãŒã‚ã‚‹ã‚ã‘ã§ã¯ãªã„ã®ã§ã‚µã‚¤ãƒˆã«ã‚ˆã£ã¦å¯¾å¿œã¯ã¾ã¡ã¾ã¡  
ä¸€å¿œã‚„ã‚Šæ–¹ã¨ã—ã¦ã¯ã‚ã‚‹ç¨‹åº¦ã®å…±é€šèªè­˜ã¯ã‚ã‚Šãã†ã ãŒã€ã“ã®è¨˜äº‹ã§ã¯ç§ãŒå€‹äººçš„ã«è‰¯ã„ã¨æ€ã£ãŸã‚„ã‚Šæ–¹ã‚’ä¸­å¿ƒã«å–ã‚Šä¸Šã’ã¦ã„ãã¾ã™ã€‚

ãƒ€ãƒ¼ã‚¯ãƒ¢ãƒ¼ãƒ‰ã®å¯¾å¿œã¨ã—ã¦å¤šã„ã®ãŒCSSå¤‰æ•°ã‚’åˆ©ç”¨ã—ã¦è‰²ã‚’å®šç¾©ã—ã€`body`ã‚„`html`ã‚¿ã‚°ã®ã‚¯ãƒ©ã‚¹åã‚’å¤‰åŒ–ã•ã›ã¦è‰²ã®å®šç¾©ã‚’åˆ‡ã‚Šæ›¿ãˆã‚‹æ–¹æ³•ã ã¨æ€ã†ã€‚  
ã‚¤ãƒ¡ãƒ¼ã‚¸ã¨ã—ã¦ã¯ä¸‹è¨˜ã®ã‚ˆã†ãªã‚³ãƒ¼ãƒ‰ã«ãªã‚‹ã¨æ€ã†ã€‚

```css:color.css
/* ãƒ‡ãƒ•ã‚©ãƒ«ãƒˆã®é…è‰²ã‚’å®šç¾© */
:root {
  --c-primary: #c75000;
  --c-white: #fff;
  --c-light: #eee;
  --c-lighter: #ccc;
  --c-black: #000;
  --c-dark: #111;
  --c-darker: #333;
}

/* ãƒ€ãƒ¼ã‚¯ãƒ¢ãƒ¼ãƒ‰æ™‚ã«é…è‰²ãŒå…¥ã‚Œæ›¿ã‚ã‚‹ã‚ˆã†ã«è¨­å®š */
html.dark {
  --c-primary: #c75000;
  --c-white: #000;
  --c-light: #111;
  --c-lighter: #333;
  --c-black: #fff;
  --c-dark: #eee;
  --c-darker: #ccc;
}

/* å®šç¾©ã—ãŸè‰²ã‚’ä½¿ç”¨ã—ã¦ã‚¹ã‚¿ã‚¤ãƒ«ã‚’çµ„ã‚“ã§ã„ã */
body {
  background-color: var(--c-lighter);
  color: var(--c-darker);
}
```

ã‚ãã¾ã§ä¸€ä¾‹ã ãŒJSã®å®Ÿè£…ã¯ã“ã‚“ãªæ„Ÿã˜ã§

```js:darkMode.js
let darkMode = false;

/** ãƒ€ãƒ¼ã‚¯ãƒ¢ãƒ¼ãƒ‰å¤‰æ›´ç”¨ã®é–¢æ•°ã‚’å®šç¾© */
const toggleDarkMode = () => {
  darkMode = !darkMode;
  const theme = darkMode ? 'dark' : 'light';

  // classã®å¤‰æ›´
  document.documentElement.classList.remove('dark', 'light');
  document.documentElement.classList.add(theme);
};

// ãƒˆã‚°ãƒ«ç”¨ã®è¦ç´ ãªã©ãŒã‚ã‚Œã°ã‚¤ãƒ™ãƒ³ãƒˆã‚’å®šç¾©
const toggleElement = document.querySelector('.toggle-button');
toggleElement.addEventListener('click', toggleDarkMode);
```

ã—ã‹ã—ã€ã“ã®å¯¾å¿œã ã‘ã§ã¯ã„ãã¤ã‹æº€ãŸã›ã¦ã„ãªã„è¦ä»¶ãŒã‚ã‚‹ã®ã§æ¬¡é …ã‹ã‚‰ã¯ãã®è¦ä»¶ã‚’æº€ãŸã™ãŸã‚ã®å·¥å¤«ã‚’ç´¹ä»‹ã—ã¾ã™ã€‚

## ãƒ–ãƒ©ã‚¦ã‚¶ã®ãƒ‡ãƒ•ã‚©ãƒ«ãƒˆUIãƒ‘ãƒ¼ãƒ„ãŒæµ®ã„ã¦ã—ã¾ã†å•é¡Œ

https://hail2u.net/blog/meta-name-color-scheme.html

ã“ã®è¨˜äº‹ã«ã‚‚ã‚ã‚‹ã‚ˆã†ã«å˜ç´”ã«CSSå´ã§ãƒ€ãƒ¼ã‚¯ãƒ¢ãƒ¼ãƒ‰ã‚’åˆ‡ã‚Šæ›¿ãˆã‚‹å ´åˆã€ãƒ–ãƒ©ã‚¦ã‚¶ã«ãƒ†ãƒ¼ãƒæƒ…å ±ãŒä¼ã‚ã‚‰ãšãƒ‡ãƒ•ã‚©ãƒ«ãƒˆã®UIãƒ‘ãƒ¼ãƒ„ãŒæ˜ã‚‹ã„ã¾ã¾ã«ãªã£ã¦ã—ã¾ã†ã€‚

### meta\[name="color-scheme"]ã¨çµ„ã¿åˆã‚ã›ã‚‹

ãã®ãŸã‚é€šå¸¸ã®CSSã§ã®åˆ¶å¾¡ã¨ã‚ã‚ã›ã¦metaã®å®šç¾©ã¨å¤‰æ›´ã‚’è¡Œã†ã€‚  
ã¾ãšã¯ä¸‹è¨˜ã®metaã‚’è¿½åŠ ã—ã¦

```html:index.html
<meta name="color-scheme" content="light dark">
```

::: message
`meta[name="color-scheme"]`ã¯ãƒ–ãƒ©ã‚¦ã‚¶ãªã©ã«ã‚µã‚¤ãƒˆãŒã©ã®ãƒ†ãƒ¼ãƒã«å¯¾å¿œã—ã¦ã„ã‚‹ã‹ã‚’ä¼ãˆã‚‹ãŸã‚ã®metaæƒ…å ±ã§ã™ã€‚  
ãã®ãŸã‚åˆæœŸè¡¨ç¤ºæ™‚ç‚¹ã§ã¯`light dark`ã¨ã„ã†è¨˜è¿°ãŒå¥½ã¾ã—ã„ã¨è€ƒãˆã¦ã„ã¾ã™ã€‚
:::

JSã®è¨˜è¿°ã«metaã®æƒ…å ±ã‚’æ›¸ãæ›ãˆã‚‹ã‚ˆã†ã«è¨˜è¿°ã‚’è¿½åŠ 

```diff javascript:darkMode.js
+ const colorScheme = document.head.querySelector('[name="color-scheme"]');
let darkMode = false;

/** ãƒ€ãƒ¼ã‚¯ãƒ¢ãƒ¼ãƒ‰å¤‰æ›´ç”¨ã®é–¢æ•°ã‚’å®šç¾© */
const toggleDarkMode = () => {
  darkMode = !darkMode;
  const theme = darkMode ? 'dark' : 'light';

+ // metaã®æ›¸ãæ›ãˆ
+ colorScheme.content = theme;
  // classã®å¤‰æ›´
  document.documentElement.classList.remove('dark', 'light');
  document.documentElement.classList.add(theme);
};

// ãƒˆã‚°ãƒ«ç”¨ã®è¦ç´ ãªã©ãŒã‚ã‚Œã°ã‚¤ãƒ™ãƒ³ãƒˆã‚’å®šç¾©
const toggleElement = document.querySelector('.toggle-button');
toggleElement.addEventListener('click', toggleDarkMode);
```

### CSSã®color-schemeã‚’åˆ©ç”¨ã™ã‚‹

ã‚‚ã—ãã¯ã€metaã®æ›¸ãæ›ãˆã‚’è¡Œã‚ãšã«CSSã§ã‚‚[`color-scheme`](https://developer.mozilla.org/ja/docs/Web/CSS/color-scheme)ã¨ã„ã†ãƒ—ãƒ­ãƒ‘ãƒ†ã‚£ã‚’åˆ©ç”¨ã—åŒã˜ã‚ˆã†ã«ãƒ†ãƒ¼ãƒã‚’é©ç”¨å¯èƒ½ã§ã™ã€‚

```diff css:color.css
/* ãƒ‡ãƒ•ã‚©ãƒ«ãƒˆã®é…è‰²ã‚’å®šç¾© */
:root {
+ color-scheme: light;
  --c-primary: #c75000;
  --c-white: #fff;
  --c-light: #eee;
  --c-lighter: #ccc;
  --c-black: #000;
  --c-dark: #111;
  --c-darker: #333;
}

/* ãƒ€ãƒ¼ã‚¯ãƒ¢ãƒ¼ãƒ‰æ™‚ã«é…è‰²ãŒå…¥ã‚Œæ›¿ã‚ã‚‹ã‚ˆã†ã«è¨­å®š */
html.dark {
+ color-scheme: dark;
  --c-primary: #c75000;
  --c-white: #000;
  --c-light: #111;
  --c-lighter: #333;
  --c-black: #fff;
  --c-dark: #eee;
  --c-darker: #ccc;
}

/* å®šç¾©ã—ãŸè‰²ã‚’ä½¿ç”¨ã—ã¦ã‚¹ã‚¿ã‚¤ãƒ«ã‚’çµ„ã‚“ã§ã„ã */
body {
  background-color: var(--c-lighter);
  color: var(--c-darker);
}
```

## ãƒ¦ãƒ¼ã‚¶ãƒ¼ã®è¨­å®šãŒåæ˜ ã•ã‚Œã¦ã„ãªã„å•é¡Œ

ãƒ¡ãƒ‡ã‚£ã‚¢ã‚¯ã‚¨ãƒªã®ä¸­ã«`prefers-color-scheme`ã¨ã„ã†ã‚‚ã®ãŒã‚ã‚Šã¾ã™ã€ã“ã‚Œã¯OSãªã©ã®è¨­å®šã§ãƒ¦ãƒ¼ã‚¶ãƒ¼ãŒã©ã®ã‚ˆã†ãªãƒ†ãƒ¼ãƒã‚’å¸Œæœ›ã—ã¦ã„ã‚‹ã®ã‹  
ï¼ˆç¾æ™‚ç‚¹ã§ã¯`light`ã¨`dark`ï¼‰ã‚’å—ã‘å–ã‚‹ã“ã¨ã®ã§ãã‚‹ãƒ¡ãƒ‡ã‚£ã‚¢ã‚¯ã‚¨ãƒªã§ã™ã€‚  
ã“ã®ãƒ¡ãƒ‡ã‚£ã‚¢ã‚¯ã‚¨ãƒªã¯ãƒ¦ãƒ¼ã‚¶ãƒ¼ã®æ˜ç¤ºçš„ãªæ„æ€ã¨æ‰ãˆã¦å·®ã—æ”¯ãˆãªã„ã¨æ€ã„ã¾ã™ã®ã§åˆæœŸè¡¨ç¤ºã‚’ã©ã¡ã‚‰ã§è¡Œã†ã®ã‹ã¨ã„ã†ãƒ’ãƒ³ãƒˆã«ãªã‚‹ã¨æ€ã„ã¾ã™ã€‚  
ã¾ãŸã€W3Cã®ä»•æ§˜[(Media Queries Level 5)](https://drafts.csswg.org/mediaqueries-5/#prefers-color-scheme)ã§`prefers-color-scheme`ã®é …ç›®ã‚’è¦‹ã‚‹ã¨ä¸‹è¨˜ã®ã‚ˆã†ãªæ³¨é‡ˆãŒã‚ã‚Šã¾ã™ã€‚

> Note: The values for this feature might be expanded in the future (to express a more active preference for light color schemes, or preferences for other types of color schemes like "sepia"). As such, the most future-friendly way to use this media feature is by negation such as (prefers-color-scheme: dark) and (not (prefers-color-scheme: dark)), which ensures that new values fall into at least one of the styling blocks.

:::details DeepLè¨³
æ³¨ï¼šã“ã®æ©Ÿèƒ½ã®å€¤ã¯å°†æ¥æ‹¡å¼µã•ã‚Œã‚‹å¯èƒ½æ€§ãŒã‚ã‚‹ï¼ˆæ˜ã‚‹ã„é…è‰²ã‚’ã‚ˆã‚Šç©æ¥µçš„ã«å¥½ã‚€ã€ã‚ã‚‹ã„ã¯ "ã‚»ãƒ”ã‚¢ "ãªã©ä»–ã®ã‚¿ã‚¤ãƒ—ã®é…è‰²ã‚’å¥½ã‚€ã“ã¨ã‚’è¡¨ç¾ã™ã‚‹ï¼‰ã€‚ãã®ãŸã‚ã€ã“ã®ãƒ¡ãƒ‡ã‚£ã‚¢æ©Ÿèƒ½ã‚’ä½¿ã†æœ€ã‚‚æœªæ¥ã«å„ªã—ã„æ–¹æ³•ã¯ã€ (prefers-color-scheme: dark) ã‚„ (not (prefers-color-scheme: dark)) ã®ã‚ˆã†ãªå¦å®šã«ã‚ˆã‚‹ã‚‚ã®ã§ã€æ–°ã—ã„å€¤ãŒå°‘ãªãã¨ã‚‚ä¸€ã¤ã®ã‚¹ã‚¿ã‚¤ãƒ«ãƒ–ãƒ­ãƒƒã‚¯ã«å…¥ã‚‹ã“ã¨ã‚’ä¿è¨¼ã™ã‚‹ã‚‚ã®ã§ã‚ã‚‹ã€‚
:::

https://drafts.csswg.org/mediaqueries-5/#prefers-color-scheme

GitHubã‚„VSCodeã®ãƒ†ãƒ¼ãƒãªã©ã§ã‚‚å˜ç´”ã«ãƒ€ãƒ¼ã‚¯ãƒ¢ãƒ¼ãƒ‰ã¨ã„ã†ã ã‘ã§ã¯ãªãã‚³ãƒ³ãƒˆãƒ©ã‚¹ãƒˆæ¯”ã®é«˜ã„ã‚‚ã®ã¨ä½ã„ã‚‚ã®ãŒã‚ã‚‹ã®ã§å°†æ¥çš„ã«ã¯ãã†ã„ã£ãŸè¨­å®šã‚‚åæ˜ ã§ãã‚‹ã‚ˆã†ã«ã™ã‚‹ã®ã ã‚ã†ã‹ã€‚  
ã¨ã‚‚ã‚ã‚Œã€å°†æ¥çš„ã«`dark` `light`ä»¥å¤–ã«ã‚‚æ‹¡å¼µã•ã‚Œã‚‹å¯èƒ½æ€§ãŒã‚ã‚‹ã‚ˆã†ãªã®ã§ãã‚Œã‚‚è€ƒæ…®ã™ã‚‹ã€‚  
ï¼ˆã¨ã„ã£ã¦ã‚‚ã©ã¡ã‚‰ã§ã‚‚ãªã„å ´åˆã®ãƒ•ã‚©ãƒ¼ãƒ«ãƒãƒƒã‚¯ç”¨ã®è¨­å®šã‚’è¿½è¨˜ã—ã¦ãŠãã ã‘ã§ã™ãŒï¼‰

```diff js:darkMode.js
+ const isDarkMode = window.matchMedia("(prefers-color-scheme: dark)").matches;
+ const isLightMode = window.matchMedia("(prefers-color-scheme: light)").matches;
const colorScheme = document.head.querySelector('[name="color-scheme"]');
let darkMode = false;

/** ãƒ€ãƒ¼ã‚¯ãƒ¢ãƒ¼ãƒ‰å¤‰æ›´ç”¨ã®é–¢æ•°ã‚’å®šç¾© */
const toggleDarkMode = () => {
  darkMode = !darkMode;
  const theme = darkMode ? 'dark' : 'light';

  // metaã®æ›¸ãæ›ãˆ
  colorScheme.content = theme;
  // classã®å¤‰æ›´
  document.documentElement.classList.remove('dark', 'light');
  document.documentElement.classList.add(theme);
};

+ if(isDarkMode) {
+   darkMode = true;
+   toggleDarkMode();
+ } else if (isLightMode) {
+   darkMode = false;
+ } else {
+   // dark lightä»¥å¤–ã®æŒ‡å®šãŒã‚ã£ãŸå ´åˆã®å®šç¾©
+   darkMode = false
+ }

// ãƒˆã‚°ãƒ«ç”¨ã®è¦ç´ ãªã©ãŒã‚ã‚Œã°ã‚¤ãƒ™ãƒ³ãƒˆã‚’å®šç¾©
const toggleElement = document.querySelector('.toggle-button');
toggleElement.addEventListener('click', toggleDarkMode);
```

ç¶™ãè¶³ã—ã§ã‚³ãƒ¼ãƒ‰ã‚’è¿½åŠ ã—ã¦ã„ã£ã¦ã—ã¾ã£ãŸã®ã§ã€å®Ÿå‹™ã§ä½¿ç”¨ã™ã‚‹å ´åˆã¯ã‚‚ã†å°‘ã—å†…å®¹ã‚’æ•´ç†ã™ã‚‹ã¨æ€ã„ã¾ã™ãŒå¯¾å¿œç®‡æ‰€ã®ã¾ã¨ã‚ã¯ã§ããŸã¨æ€ã†ã®ã§ã²ã¨ã¾ãšã“ã“ã¾ã§ã€‚

## è£œè¶³è³‡æ–™

ã“ã®è¨˜äº‹ã‚’æ›¸ãéš›ã«å‚è€ƒã«ã—ãŸè³‡æ–™ãªã©

### å‚è€ƒã«ã—ãŸè¨˜äº‹ã‚„ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆ

https://hail2u.net/blog/meta-name-color-scheme.html
https://developer.mozilla.org/ja/docs/Web/API/Window/matchMedia
https://developer.mozilla.org/ja/docs/Web/CSS/@media/prefers-color-scheme
https://developer.mozilla.org/ja/docs/Web/CSS/color-scheme
https://drafts.csswg.org/mediaqueries-5/#prefers-color-scheme
